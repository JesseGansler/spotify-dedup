{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./app/scripts/oauth-config.js","webpack:///./app/scripts/custom-fetch.js","webpack:///./app/scripts/promiseForPages.js","webpack:///./app/scripts/deduplicator.js","webpack:///./node_modules/style-loader/lib/addStyles.js","webpack:///./app/scripts/oauth-manager.js","webpack:///./app/favicon.ico","webpack:///./app/styles/custom.css","webpack:///./node_modules/style-loader/lib/urls.js","webpack:///./app/styles/main.css","webpack:///./node_modules/promise-throttle/lib/main.js","webpack:///(webpack)/buildin/global.js","webpack:///./app/scripts/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","redirectUri","location","host","exec","__webpack_exports__","clientId","timeoutBetweenFailingRequests","queue","isOngoingRequest","async","tryToExecute","length","next","shift","execute","promise","resolve","reject","url","options","retries","console","log","response","fetch","success","status","setTimeout","Math","random","e","Promise","push","then","promisesForPages","initialRequest","promiseThrottle","api","fetchGeneric","results","offset","limit","getGeneric","href","indexOf","substr","stripParameters","promises","total","reduce","func","result","Array","concat","BaseDeduplicator","[object Object]","this","model","tracks","seenIds","seenNameAndArtist","duplicates","track","index","id","isDuplicate","seenNameAndArtistKey","artists","abs","duration_ms","reason","deduplicator_PlaylistDeduplicator","super","playlist","pagePromises","all","pages","forEach","page","items","item","catch","playlistModel","collaborative","tracksToRemove","map","uri","linked_from","positions","reverse","chunk","splice","removeTracksFromPlaylist","owner","deduplicator_SavedTracksDeduplicator","removeFromMySavedTracks","stylesInDom","isOldIE","fn","memo","apply","arguments","memoize","window","document","atob","getElement","target","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","refs","j","parts","addStyle","listToStyles","list","newStyles","base","part","css","media","sourceMap","insertStyleElement","style","insertInto","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","idx","createStyleElement","createElement","undefined","attrs","type","addAttrs","el","keys","setAttribute","obj","update","remove","transform","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","btoa","link","rel","createLinkElement","autoFixUrls","convertToAbsoluteUrls","unescape","encodeURIComponent","JSON","stringify","blob","oldSrc","styleSheet","cssText","createTextNode","newObj","DEBUG","newList","mayRemove","replaceText","textStore","replacement","filter","Boolean","join","cssNode","childNodes","obtainToken","authWindow","pollAuthWindowClosed","addEventListener","receiveMessage","event","clearInterval","origin","_oauth_config__WEBPACK_IMPORTED_MODULE_0__","close","removeEventListener","data","left","screen","width","top","height","params","client_id","redirect_uri","response_type","scopes","scope","open","toQueryString","setInterval","closed","message","content","hmr","locals","baseUrl","protocol","currentDir","pathname","replace","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","test","PromiseThrottle","requestsPerSecond","promiseImplementation","lastStartTime","queued","add","self","opt","weight","signal","dequeue","addAll","addedPromises","now","Date","inc","elapsed","_execute","candidate","aborted","DOMException","g","Function","eval","retryOnCodes","playlistCache","localStorage","getItem","snapshot_id","setItem","apiPrefix","SpotifyWebApi","token","optionsString","k","res","_custom_fetch__WEBPACK_IMPORTED_MODULE_3__","method","headers","Authorization","retryOn","json","ok","userId","playlistId","uris","dataToBeSent","body","global","Raven","captureMessage","extra","trackIds","init","playlistDeduplicator","savedTracksDeduplicator","app","Vue","isLoggedIn","toProcess","playlists","savedTracks","methods","removeDuplicates","alert","ga","removeDuplicatesInSavedTracks","computed","prev","current","getElementById","_oauth_manager__WEBPACK_IMPORTED_MODULE_1__","accessToken","setAccessToken","_deduplicator__WEBPACK_IMPORTED_MODULE_2__","attempts","loginFunction","getMe","user","playlistsToCheck","ownedPlaylists","u","getUserPlaylists","userOwnedPlaylists","fetchUserOwnedPlaylists","playlistToPlaylistModel","getTracks","getMySavedTracks","findDuplicatedTracks","needsCheckForDuplicates","playlistTracks","storePlaylistWithoutDuplicates","processed","remaining","onPlaylistProcessed","onUserDataFetched","onTokenReceived","error","config","install","context"],"mappings":"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","file":"main.e8a20904c3765b0befb5.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n","const clientId = '04dca0de1c4e4aca88cc615ac23581be';\nconst redirectUri =\n  location.host === 'localhost:8005'\n    ? 'http://localhost:8005/callback.html'\n    : 'https://jmperezperez.com/spotify-dedup/callback.html';\n\nconst host = /http[s]?:\\/\\/[^/]+/.exec(redirectUri)[0];\n\nexport default {\n  clientId,\n  redirectUri,\n  host\n};\n","const maxRequestsPerSecond = 4;\nconst times = [];\nconst timeoutBetweenFailingRequests = 2000;\nconst queue = [];\nlet isOngoingRequest = false;\n\nasync function execute({ promise, resolve, reject, url, options, retries }) {\n  console.log('execute');\n  try {\n    let response = await fetch(url, options);\n    let success = response.status < 400;\n    if (!success) {\n      console.log(\n        'got status ' + response.status + ' with retries ' + retries,\n        url,\n        options\n      );\n    }\n    if (success) {\n      resolve(response);\n    } else if (--retries > 0) {\n      setTimeout(() => {\n        execute({ promise, resolve, reject, url, options, retries });\n      }, timeoutBetweenFailingRequests + Math.random() * 5000);\n    } else {\n      reject(response);\n    }\n  } catch (e) {\n    if (--retries > 0) {\n      setTimeout(() => {\n        execute({ promise, resolve, reject, url, options, retries });\n      }, timeoutBetweenFailingRequests + Math.random() * 2000);\n    } else {\n      reject(response);\n    }\n  }\n}\n\nasync function tryToExecute() {\n  if (!isOngoingRequest && queue.length > 0) {\n    isOngoingRequest = true;\n    const next = queue.shift();\n    execute({\n      promise: next.promise,\n      resolve: next.resolve,\n      reject: next.reject,\n      url: next.url,\n      options: next.options,\n      retries: next.retries\n    });\n  }\n}\n\nasync function customFetch(url, options) {\n  console.log('customFetch', { url, options });\n  let retries = 3;\n  let response = null;\n  let success = false;\n\n  const promise = new Promise((resolve, reject) => {\n    queue.push({ promise: null, resolve, reject, url, options, retries });\n  });\n\n  tryToExecute();\n\n  /*let waitingTime =\n      times.length === maxRequestsPerSecond && Date.now() - times[0] < 1000\n        ? Date.now() - times[0]\n        : 0;\n    console.log('waiting for ' + waitingTime + 'ms');\n    setTimeout(tryRequest, waitingTime);*/\n\n  promise.then(r => {\n    isOngoingRequest = false;\n    tryToExecute();\n  });\n\n  return promise;\n}\n\nexport default customFetch;\n","import fetch from './custom-fetch';\nexport default async function promisesForPages(\n  initialRequest,\n  promiseThrottle,\n  api\n) {\n  function stripParameters(href) {\n    return href.indexOf('?') !== -1 ? href.substr(0, href.indexOf('?')) : href;\n  }\n\n  async function fetchGeneric(results, offset, limit) {\n    return api.getGeneric(\n      `${stripParameters(results.href)}?offset=${offset}&limit=${limit}`\n    );\n  }\n\n  const results = await initialRequest;\n  if (results === null) {\n    return [];\n  }\n\n  const promises = [() => initialRequest];\n  let offset = results.limit + results.offset;\n  const limit = results.limit;\n  while (results.total > offset) {\n    (function(results, offset, limit) {\n      console.log(offset, limit);\n      const q = () => fetchGeneric(results, offset, limit);\n      promises.push(q);\n    })(results, offset, limit);\n    offset += limit;\n  }\n\n  return promises.reduce(\n    (promise, func) =>\n      promise.then(result => func().then(Array.prototype.concat.bind(result))),\n    Promise.resolve([])\n  );\n}\n","import fetch from './custom-fetch';\nimport promisesForPages from './promiseForPages';\n\nlet token;\nlet api;\n\nclass BaseDeduplicator {\n  constructor(api, promiseThrottle) {\n    this.api = api;\n    this.promiseThrottle = promiseThrottle;\n  }\n\n  async removeDuplicates(model) {\n    throw 'Not implemented';\n  }\n\n  async getTracks() {\n    throw 'Not implemented';\n  }\n\n  findDuplicatedTracks(tracks) {\n    const seenIds = {};\n    const seenNameAndArtist = {};\n    const result = tracks.reduce((duplicates, track, index) => {\n      if (track === null) return duplicates;\n      if (track.id === null) return duplicates;\n      let isDuplicate = false;\n      const seenNameAndArtistKey = `${track.name}:${track.artists[0].name}`;\n      if (track.id in seenIds) {\n        // if the two tracks have the same Spotify ID, they are duplicates\n        isDuplicate = true;\n      } else {\n        // if they have the same name, main artist, and roughly same duration\n        // we consider tem duplicates too\n        if (\n          seenNameAndArtistKey in seenNameAndArtist &&\n          Math.abs(\n            seenNameAndArtist[seenNameAndArtistKey] - track.duration_ms\n          ) < 2000\n        ) {\n          isDuplicate = true;\n        }\n      }\n      if (isDuplicate) {\n        duplicates.push({\n          index: index,\n          track: track,\n          reason: track.id in seenIds ? 'same-id' : 'same-name-artist'\n        });\n      } else {\n        seenIds[track.id] = true;\n        seenNameAndArtist[seenNameAndArtistKey] = track.duration_ms;\n      }\n      return duplicates;\n    }, []);\n    return result;\n  }\n}\n\nexport class PlaylistDeduplicator extends BaseDeduplicator {\n  constructor(api, promiseThrottle) {\n    super(api, promiseThrottle);\n  }\n  async getTracks(playlist) {\n    return new Promise((resolve, reject) => {\n      const tracks = [];\n      promisesForPages(\n        this.api.getGeneric(playlist.tracks.href), // 'https://api.spotify.com/v1/users/11153223185/playlists/0yygtDHfwC7uITHxfrcQsF/tracks'\n        this.promiseThrottle,\n        this.api\n      )\n        .then((\n          pagePromises // todo: I'd love to replace this with\n        ) =>\n          // .then(Promise.all)\n          // à la http://www.html5rocks.com/en/tutorials/es6/promises/#toc-transforming-values\n          Promise.all(pagePromises)\n        )\n        .then(pages => {\n          pages.forEach(page => {\n            page.items.forEach((item, index) => {\n              tracks.push(item.track);\n            });\n          });\n          resolve(tracks);\n        })\n        .catch(reject);\n    });\n  }\n\n  async removeDuplicates(playlistModel) {\n    return new Promise((resolve, reject) => {\n      if (playlistModel.playlist.id === 'starred') {\n        reject(\n          'It is not possible to delete duplicates from your Starred playlist using this tool since this is not supported in the Spotify Web API. You will need to remove these manually.'\n        );\n      }\n      if (playlistModel.playlist.collaborative) {\n        reject(\n          'It is not possible to delete duplicates from a collaborative playlist using this tool since this is not supported in the Spotify Web API. You will need to remove these manually.'\n        );\n      } else {\n        const tracksToRemove = playlistModel.duplicates\n          .map(d => ({\n            uri: d.track.linked_from ? d.track.linked_from.uri : d.track.uri,\n            positions: [d.index]\n          }))\n          .reverse(); // reverse so we delete the last ones first\n        const promises = [];\n        do {\n          const chunk = tracksToRemove.splice(0, 100);\n          (function(playlistModel, chunk, api) {\n            promises.push(() =>\n              api.removeTracksFromPlaylist(\n                playlistModel.playlist.owner.id,\n                playlistModel.playlist.id,\n                chunk\n              )\n            );\n          })(playlistModel, chunk, this.api);\n        } while (tracksToRemove.length > 0);\n\n        promises\n          .reduce(\n            (promise, func) => promise.then(() => func()),\n            Promise.resolve(null)\n          )\n          .then(() => {\n            playlistModel.duplicates.duplicates = [];\n            resolve();\n          })\n          .catch(e => {\n            reject(e);\n          });\n      }\n    });\n  }\n}\n\nexport class SavedTracksDeduplicator extends BaseDeduplicator {\n  constructor(api, promiseThrottle) {\n    super(api, promiseThrottle);\n  }\n\n  async getTracks(initialRequest) {\n    return new Promise((resolve, reject) => {\n      const tracks = [];\n      promisesForPages(initialRequest, this.promiseThrottle, this.api)\n        .then((\n          pagePromises // todo: I'd love to replace this with\n        ) =>\n          // .then(Promise.all)\n          // à la http://www.html5rocks.com/en/tutorials/es6/promises/#toc-transforming-values\n          Promise.all(pagePromises)\n        )\n        .then(pages => {\n          pages.forEach(page => {\n            page.items.forEach((item, index) => {\n              tracks.push(item.track);\n            });\n          });\n          resolve(tracks);\n        })\n        .catch(reject);\n    });\n  }\n\n  async removeDuplicates(model) {\n    return new Promise((resolve, reject) => {\n      const tracksToRemove = model.duplicates.map(\n        d => (d.track.linked_from ? d.track.linked_from.id : d.track.id)\n      );\n      do {\n        (async () => {\n          const chunk = tracksToRemove.splice(0, 50);\n          await this.api.removeFromMySavedTracks(chunk);\n        })();\n      } while (tracksToRemove.length > 0);\n      model.duplicates = [];\n      resolve();\n    });\n  }\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","import OAuthConfig from './oauth-config';\n\nfunction toQueryString(obj) {\n  const parts = [];\n  for (const i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      parts.push(`${encodeURIComponent(i)}=${encodeURIComponent(obj[i])}`);\n    }\n  }\n  return parts.join('&');\n}\n\nfunction obtainToken(options = {}) {\n  const promise = new Promise((resolve, reject) => {\n    let authWindow = null;\n    let pollAuthWindowClosed = null;\n\n    function receiveMessage(event) {\n      clearInterval(pollAuthWindowClosed);\n      if (event.origin !== OAuthConfig.host) {\n        reject();\n        return;\n      }\n      if (authWindow !== null) {\n        authWindow.close();\n        authWindow = null;\n      }\n\n      window.removeEventListener('message', receiveMessage, false);\n\n      // todo: manage case when the user rejects the oauth\n      // or the oauth fails to obtain a token\n      resolve(event.data);\n    }\n\n    window.addEventListener('message', receiveMessage, false);\n\n    const width = 400;\n    const height = 600;\n    const left = screen.width / 2 - width / 2;\n    const top = screen.height / 2 - height / 2;\n\n    /*jshint camelcase:false*/\n    const params = {\n      client_id: OAuthConfig.clientId,\n      redirect_uri: OAuthConfig.redirectUri,\n      response_type: 'token'\n    };\n\n    if (options.scopes) {\n      params.scope = options.scopes.join(' ');\n    }\n\n    authWindow = window.open(\n      `https://accounts.spotify.com/authorize?${toQueryString(params)}`,\n      'Spotify',\n      `menubar=no,location=no,resizable=no,scrollbars=no,status=no, width=${width}, height=${height}, top=${top}, left=${left}`\n    );\n\n    pollAuthWindowClosed = setInterval(() => {\n      if (authWindow !== null) {\n        if (authWindow.closed) {\n          clearInterval(pollAuthWindowClosed);\n          reject({ message: 'access_denied' });\n        }\n      }\n    }, 1000);\n  });\n\n  return promise;\n}\n\nexport default { obtainToken };\n","module.exports = __webpack_public_path__ + \"favicon.ico\";","\nvar content = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./custom.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./custom.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./custom.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","\nvar content = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./main.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./main.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./main.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","/* exported PromiseThrottle */\n\n'use strict';\n\n/**\n * @constructor\n * @param {Object} options A set op options to pass to the throttle function\n *        @param {number} requestsPerSecond The amount of requests per second\n *                                          the library will limit to\n */\nfunction PromiseThrottle(options) {\n  this.requestsPerSecond = options.requestsPerSecond;\n  this.promiseImplementation = options.promiseImplementation || Promise;\n  this.lastStartTime = 0;\n  this.queued = [];\n}\n\n/**\n * Adds a promise\n * @param {Function} promise A function returning the promise to be added\n * @param {Object} options A set of options.\n * @param {number} options.weight A \"weight\" of each operation resolving by array of promises\n * @return {Promise} A promise\n */\nPromiseThrottle.prototype.add = function(promise, options) {\n  var self = this;\n  var opt = options || {};\n  return new self.promiseImplementation(function(resolve, reject) {\n    self.queued.push({\n      resolve: resolve,\n      reject: reject,\n      promise: promise,\n      weight: opt.weight || 1,\n      signal: opt.signal\n    });\n\n    self.dequeue();\n  });\n};\n\n/**\n * Adds all the promises passed as parameters\n * @param {Function} promises An array of functions that return a promise\n * @param {Object} options A set of options.\n * @param {number} options.weight A \"weight\" of each operation resolving by array of promises\n * @return {Promise} A promise that succeeds when all the promises passed as options do\n */\nPromiseThrottle.prototype.addAll = function(promises, options) {\n  var addedPromises = promises.map(function(promise) {\n    return this.add(promise, options);\n  }.bind(this));\n\n  return Promise.all(addedPromises);\n};\n\n/**\n * Dequeues a promise\n * @return {void}\n */\nPromiseThrottle.prototype.dequeue = function() {\n  if (this.queued.length > 0) {\n    var now = new Date(),\n      weight = this.queued[0].weight,\n      inc = (1000 / this.requestsPerSecond) * weight,\n      elapsed = now - this.lastStartTime;\n\n    if (elapsed >= inc) {\n      this._execute();\n    } else {\n      // we have reached the limit, schedule a dequeue operation\n      setTimeout(function() {\n        this.dequeue();\n      }.bind(this), inc - elapsed);\n    }\n  }\n};\n\n/**\n * Executes the promise\n * @private\n * @return {void}\n */\nPromiseThrottle.prototype._execute = function() {\n  this.lastStartTime = new Date();\n  var candidate = this.queued.shift();\n  var aborted = candidate.signal && candidate.signal.aborted;\n  if (aborted) {\n    candidate.reject(new DOMException('', 'AbortError'));\n  } else {\n    candidate.promise().then(function(r) {\n      candidate.resolve(r);\n    }).catch(function(r) {\n      candidate.reject(r);\n    });\n  }\n};\n\nmodule.exports = PromiseThrottle;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import PromiseThrottle from 'promise-throttle';\nimport OAuthManager from './oauth-manager';\nimport { PlaylistDeduplicator, SavedTracksDeduplicator } from './deduplicator';\nimport fetch from './custom-fetch';\n\nimport mainCss from '../styles/main.css';\nimport customCss from '../styles/custom.css';\nimport favicon from '../favicon.ico';\n\nconst retryOnCodes = [400, 401, 404, 429, 500, 502, 503, 504];\nclass PlaylistCache {\n  needsCheckForDuplicates(playlist) {\n    if ('snapshot_id' in playlist) {\n      try {\n        if (localStorage.getItem(playlist.snapshot_id) === '0') {\n          return false;\n        }\n      } catch (e) {\n        return true;\n      }\n    }\n    return true;\n  }\n\n  storePlaylistWithoutDuplicates(playlist) {\n    if ('snapshot_id' in playlist) {\n      try {\n        localStorage.setItem(playlist.snapshot_id, '0');\n      } catch (e) {}\n    }\n  }\n}\n\nconst playlistCache = new PlaylistCache();\n\nconst apiPrefix = 'https://api.spotify.com/v1';\n\nclass SpotifyWebApi {\n  constructor() {\n    this.token = null;\n  }\n\n  setAccessToken(token) {\n    this.token = token;\n  }\n\n  async getMe() {\n    return await this.getGeneric(`${apiPrefix}/me`);\n  }\n\n  async getGeneric(url, options) {\n    const optionsString =\n      options === undefined\n        ? ''\n        : `?${Object.keys(options)\n            .map(k => `${k}=${options[k]}`)\n            .join('&')}`;\n\n    const res = await fetch(`${url}${optionsString}`, {\n      method: 'GET',\n      headers: {\n        Authorization: `Bearer ${this.token}`\n      },\n      retryOn: retryOnCodes\n    });\n    const json = await res.json();\n    if (res.ok) return json;\n    return null;\n  }\n\n  async getUserPlaylists(userId, options) {\n    const url =\n      typeof userId === 'string'\n        ? `${apiPrefix}/users/${encodeURIComponent(userId)}/playlists`\n        : `${apiPrefix}/me/playlists`;\n    return await this.getGeneric(url, options);\n  }\n\n  async removeTracksFromPlaylist(userId, playlistId, uris) {\n    const dataToBeSent = {\n      tracks: uris.map(uri => (typeof uri === 'string' ? { uri: uri } : uri))\n    };\n\n    const res = await fetch(\n      `${apiPrefix}/users/${encodeURIComponent(\n        userId\n      )}/playlists/${playlistId}/tracks`,\n      {\n        method: 'DELETE',\n        headers: {\n          Authorization: `Bearer ${this.token}`\n        },\n        body: JSON.stringify(dataToBeSent),\n        retryOn: retryOnCodes\n      }\n    );\n\n    const json = await res.json();\n    if (res.ok) {\n      return json;\n    } else {\n      global.Raven &&\n        Raven.captureMessage(\n          `Status ${res.status} when deleting tracks from playlist`,\n          {\n            extra: {\n              json: json\n            }\n          }\n        );\n    }\n    return null;\n  }\n\n  async getMySavedTracks(options) {\n    return this.getGeneric(`${apiPrefix}/me/tracks`, options);\n  }\n\n  async removeFromMySavedTracks(trackIds) {\n    const res = await fetch(`${apiPrefix}/me/tracks`, {\n      method: 'DELETE',\n      headers: {\n        Authorization: `Bearer ${this.token}`\n      },\n      body: JSON.stringify(trackIds),\n      retryOn: retryOnCodes\n    });\n\n    if (res.ok) return true;\n    return false;\n  }\n}\n\nconst init = function() {\n  let playlistDeduplicator;\n  let savedTracksDeduplicator;\n\n  let token, api;\n\n  let app = new Vue({\n    el: '#app',\n    data: {\n      isLoggedIn: false,\n      toProcess: 100,\n      playlists: [],\n      savedTracks: {\n        duplicates: [],\n        status: ''\n      }\n    },\n    methods: {\n      removeDuplicates: playlistModel =>\n        (async () => {\n          if (playlistModel.playlist.id === 'starred') {\n            global.alert(\n              'It is not possible to delete duplicates from your Starred playlist using this tool since this is not supported in the Spotify Web API. You will need to remove these manually.'\n            );\n          }\n          if (playlistModel.playlist.collaborative) {\n            global.alert(\n              'It is not possible to delete duplicates from a collaborative playlist using this tool since this is not supported in the Spotify Web API. You will need to remove these manually.'\n            );\n          } else {\n            try {\n              const duplicates = await playlistDeduplicator.removeDuplicates(\n                playlistModel\n              );\n              playlistModel.duplicates = [];\n              playlistModel.status = 'Duplicates removed';\n              if (global.ga) {\n                ga(\n                  'send',\n                  'event',\n                  'spotify-dedup',\n                  'playlist-removed-duplicates'\n                );\n              }\n            } catch (e) {\n              global.Raven &&\n                Raven.captureMessage(\n                  `Exception trying to remove duplicates from playlist`,\n                  {\n                    extra: {\n                      duplicates: playlistModel.duplicates\n                    }\n                  }\n                );\n            }\n          }\n        })(),\n      removeDuplicatesInSavedTracks: () =>\n        (async () => {\n          const duplicates = await savedTracksDeduplicator.removeDuplicates(\n            app.savedTracks\n          );\n          app.savedTracks.duplicates = [];\n          app.savedTracks.status = 'Duplicates removed';\n          if (global.ga) {\n            ga(\n              'send',\n              'event',\n              'spotify-dedup',\n              'saved-tracks-removed-duplicates'\n            );\n          }\n        })()\n    },\n    computed: {\n      duplicates: function() {\n        return (\n          this.playlists.reduce(\n            (prev, current) => prev + current.duplicates.length,\n            0\n          ) + this.savedTracks.duplicates.length\n        );\n      }\n    }\n  });\n\n  document.getElementById('login').addEventListener('click', function() {\n    OAuthManager.obtainToken({\n      scopes: [\n        /*\n          the permission for reading public playlists is granted\n          automatically when obtaining an access token through\n          the user login form\n          */\n        'playlist-read-private',\n        'playlist-read-collaborative',\n        'playlist-modify-public',\n        'playlist-modify-private',\n        'user-library-read',\n        'user-library-modify'\n      ]\n    })\n      .then(function(token) {\n        onTokenReceived(token);\n      })\n      .catch(function(error) {\n        console.error(error);\n      });\n    // });\n\n    function fetchUserOwnedPlaylists(user) {\n      return promisesForPages(api.getUserPlaylists(user, { limit: 50 })).then(\n        function(pages) {\n          // combine and filter playlists\n          var userOwnedPlaylists = [];\n          pages.forEach(function(page) {\n            userOwnedPlaylists = userOwnedPlaylists.concat(\n              page.items.filter(function(playlist) {\n                return playlist.owner.id === user;\n              })\n            );\n          });\n          return userOwnedPlaylists;\n        }\n      );\n    }\n\n    function onPlaylistProcessed(playlist) {\n      playlist.processed = true;\n      var remaining = app.toProcess - 1;\n      app.toProcess -= 1;\n      if (remaining === 0 && global.ga) {\n        ga('send', 'event', 'spotify-dedup', 'library-processed');\n      }\n    }\n\n    const playlistToPlaylistModel = playlist => ({\n      playlist: playlist,\n      duplicates: [],\n      status: '',\n      processed: false\n    });\n\n    async function onUserDataFetched(data) {\n      var user = data.id,\n        playlistsToCheck = [];\n\n      const ownedPlaylists = await fetchUserOwnedPlaylists(user);\n      playlistsToCheck = ownedPlaylists;\n      app.playlists = playlistsToCheck.map(p => playlistToPlaylistModel(p));\n      app.toProcess = app.playlists.length + 1 /* saved tracks */;\n      const savedTracks = await savedTracksDeduplicator.getTracks(\n        api.getMySavedTracks({ limit: 50 })\n      );\n      app.savedTracks.duplicates = savedTracksDeduplicator.findDuplicatedTracks(\n        savedTracks\n      );\n      if (app.savedTracks.duplicates.length && global.ga) {\n        ga('send', 'event', 'spotify-dedup', 'saved-tracks-found-duplicates');\n      }\n      app.toProcess--;\n\n      app.playlists.forEach(playlistModel =>\n        (async () => {\n          if (playlistCache.needsCheckForDuplicates(playlistModel.playlist)) {\n            const playlistTracks = await playlistDeduplicator.getTracks(\n              playlistModel.playlist\n            );\n            playlistModel.duplicates = playlistDeduplicator.findDuplicatedTracks(\n              playlistTracks\n            );\n            if (playlistModel.duplicates.length === 0) {\n              playlistCache.storePlaylistWithoutDuplicates(\n                playlistModel.playlist\n              );\n            }\n          }\n          onPlaylistProcessed(playlistModel.playlist);\n        })()\n      );\n    }\n\n    function onTokenReceived(accessToken) {\n      app.isLoggedIn = true;\n      api = new SpotifyWebApi();\n      api.setAccessToken(accessToken);\n\n      playlistDeduplicator = new PlaylistDeduplicator(api);\n      savedTracksDeduplicator = new SavedTracksDeduplicator(api);\n\n      let attempts = 0;\n      const loginFunction = () => {\n        return api.getMe().then(data => {\n          if (data === null) {\n            attempts++;\n            global.Raven &&\n              Raven.captureMessage(`Retrying logging user in`, {\n                extra: {\n                  attempts: attempts\n                }\n              });\n            loginFunction();\n          } else {\n            (async () => {\n              await onUserDataFetched(data);\n            })();\n          }\n        });\n      };\n      loginFunction();\n    }\n\n    async function promisesForPages(initialRequest) {\n      console.log('promisesForPages!');\n      function stripParameters(href) {\n        var u = new URL(href);\n        return u.origin + u.pathname;\n      }\n\n      function fetchGeneric(results, offset, limit) {\n        return api.getGeneric(\n          stripParameters(results.href) +\n            '?offset=' +\n            offset +\n            '&limit=' +\n            limit\n        );\n      }\n\n      console.log(initialRequest);\n      const results = await initialRequest;\n      console.log('got initial request', results);\n      if (results === null) {\n        return [];\n      }\n      const promises = [() => initialRequest];\n      let offset = results.limit + results.offset;\n      const limit = results.limit;\n      while (results.total > offset) {\n        (function(results, offset, limit) {\n          const q = () => fetchGeneric(results, offset, limit);\n          promises.push(q);\n        })(results, offset, limit);\n        offset += limit;\n      }\n\n      console.log(promises[0]());\n      return promises.reduce(\n        (promise, func) =>\n          promise.then(result => {\n            console.log('executing', func);\n            return func().then(Array.prototype.concat.bind(result));\n          }),\n        Promise.resolve([])\n      );\n    }\n  });\n};\n\nglobal.Raven &&\n  Raven.config(\n    'https://22cbac299caf4962b74de18bc87a8d74@sentry.io/1239123'\n  ).install();\n\nif (global.Raven) {\n  Raven.context(init);\n} else {\n  init();\n}\n"],"sourceRoot":""}